# 🚀 XReader 快速启动指南

## 立即开始开发

### 1. 创建项目
```bash
# 创建Flutter项目
flutter create xreader --platforms android,ios

# 进入项目目录
cd xreader

# 检查Flutter环境
flutter doctor
```

### 2. 配置依赖
将以下内容添加到 `pubspec.yaml`：

```yaml
name: xreader
description: 极简电子书阅读器

publish_to: 'none'

version: 1.0.0+1

environment:
  sdk: '>=3.0.0 <4.0.0'
  flutter: ">=3.10.0"

dependencies:
  flutter:
    sdk: flutter
  
  # 状态管理
  riverpod: ^2.4.9
  flutter_riverpod: ^2.4.9
  
  # 数据库
  isar: ^3.1.0+1
  isar_flutter_libs: ^3.1.0+1
  
  # 文件处理
  path_provider: ^2.1.1
  file_picker: ^6.1.1
  
  # 电子书解析
  epubx: ^4.0.0
  syncfusion_flutter_pdfviewer: ^23.2.7
  
  # UI组件
  flutter_screenutil: ^5.9.0
  google_fonts: ^6.1.0
  
  # 动画
  animations: ^2.0.8

dev_dependencies:
  flutter_test:
    sdk: flutter
  build_runner: ^2.4.7
  isar_generator: ^3.1.0+1
  flutter_lints: ^3.0.1

flutter:
  uses-material-design: true
  
  assets:
    - assets/images/
    - assets/icons/
```

### 3. 安装依赖
```bash
flutter pub get
```

### 4. 创建基础项目结构
```bash
# 在lib目录下创建以下结构
mkdir -p lib/core/{constants,themes,utils,services}
mkdir -p lib/features/{bookshelf,reader,settings}
mkdir -p lib/shared/{widgets,models}
mkdir -p lib/data/{repositories,datasources,models}

# 创建资源目录
mkdir -p assets/{images,icons}
```

### 5. 第一天开发任务

#### 任务1：配置应用主题
创建 `lib/core/themes/app_theme.dart`：

```dart
import 'package:flutter/material.dart';
import 'package:google_fonts/google_fonts.dart';

class AppTheme {
  // 颜色定义
  static const Color primaryBlue = Color(0xFF4A90E2);
  static const Color backgroundColor = Color(0xFFFFFFFF);
  static const Color creamBackground = Color(0xFFFAF3E0);
  static const Color darkBackground = Color(0xFF1E1E1E);
  static const Color blackBackground = Color(0xFF000000);
  static const Color textDark = Color(0xFF222222);
  static const Color textGray = Color(0xFF666666);
  static const Color forestGreen = Color(0xFF2E3D34);

  // 明亮主题
  static ThemeData get lightTheme {
    return ThemeData(
      useMaterial3: true,
      brightness: Brightness.light,
      primarySwatch: _createMaterialColor(primaryBlue),
      scaffoldBackgroundColor: backgroundColor,
      cardColor: Colors.white,
      appBarTheme: AppBarTheme(
        backgroundColor: Colors.transparent,
        elevation: 0,
        iconTheme: IconThemeData(color: textDark),
        titleTextStyle: GoogleFonts.notoSansSC(
          color: textDark,
          fontSize: 22,
          fontWeight: FontWeight.w500,
        ),
      ),
      textTheme: TextTheme(
        displayLarge: GoogleFonts.sourceSerif4(
          color: textDark,
          fontSize: 32,
          fontWeight: FontWeight.bold,
        ),
        bodyLarge: GoogleFonts.sourceSerif4(
          color: textDark,
          fontSize: 18,
          height: 1.6,
        ),
        bodyMedium: GoogleFonts.notoSansSC(
          color: textDark,
          fontSize: 16,
        ),
        labelMedium: GoogleFonts.notoSansSC(
          color: textGray,
          fontSize: 14,
        ),
      ),
      bottomNavigationBarTheme: BottomNavigationBarThemeData(
        backgroundColor: Colors.white,
        selectedItemColor: primaryBlue,
        unselectedItemColor: textGray,
        elevation: 8,
      ),
    );
  }

  // 夜间主题
  static ThemeData get darkTheme {
    return ThemeData(
      useMaterial3: true,
      brightness: Brightness.dark,
      primarySwatch: _createMaterialColor(primaryBlue),
      scaffoldBackgroundColor: blackBackground,
      cardColor: darkBackground,
      appBarTheme: AppBarTheme(
        backgroundColor: Colors.transparent,
        elevation: 0,
        iconTheme: IconThemeData(color: Colors.white),
        titleTextStyle: GoogleFonts.notoSansSC(
          color: Colors.white,
          fontSize: 22,
          fontWeight: FontWeight.w500,
        ),
      ),
      textTheme: TextTheme(
        displayLarge: GoogleFonts.sourceSerif4(
          color: Colors.white,
          fontSize: 32,
          fontWeight: FontWeight.bold,
        ),
        bodyLarge: GoogleFonts.sourceSerif4(
          color: Colors.white,
          fontSize: 18,
          height: 1.6,
        ),
        bodyMedium: GoogleFonts.notoSansSC(
          color: Colors.white,
          fontSize: 16,
        ),
        labelMedium: GoogleFonts.notoSansSC(
          color: Colors.white70,
          fontSize: 14,
        ),
      ),
      bottomNavigationBarTheme: BottomNavigationBarThemeData(
        backgroundColor: darkBackground,
        selectedItemColor: primaryBlue,
        unselectedItemColor: Colors.white70,
        elevation: 8,
      ),
    );
  }

  static MaterialColor _createMaterialColor(Color color) {
    List strengths = <double>[.05];
    Map<int, Color> swatch = <int, Color>{};
    final int r = color.red, g = color.green, b = color.blue;

    for (int i = 1; i < 10; i++) {
      strengths.add(0.1 * i);
    }
    for (var strength in strengths) {
      final double ds = 0.5 - strength;
      swatch[(strength * 1000).round()] = Color.fromRGBO(
        r + ((ds < 0 ? r : (255 - r)) * ds).round(),
        g + ((ds < 0 ? g : (255 - g)) * ds).round(),
        b + ((ds < 0 ? b : (255 - b)) * ds).round(),
        1,
      );
    }
    return MaterialColor(color.value, swatch);
  }
}
```

#### 任务2：创建应用入口
更新 `lib/main.dart`：

```dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:flutter_screenutil/flutter_screenutil.dart';
import 'core/themes/app_theme.dart';
import 'app.dart';

void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  
  // 初始化数据库等服务
  // await DatabaseService.initialize();
  
  runApp(
    ProviderScope(
      child: MyApp(),
    ),
  );
}

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return ScreenUtilInit(
      designSize: Size(375, 812), // iPhone X尺寸作为设计稿
      minTextAdapt: true,
      splitScreenMode: true,
      builder: (context, child) {
        return MaterialApp(
          title: 'XReader',
          debugShowCheckedModeBanner: false,
          theme: AppTheme.lightTheme,
          darkTheme: AppTheme.darkTheme,
          themeMode: ThemeMode.system,
          home: AppNavigator(),
        );
      },
    );
  }
}
```

#### 任务3：创建主导航
创建 `lib/app.dart`：

```dart
import 'package:flutter/material.dart';
import 'package:flutter_screenutil/flutter_screenutil.dart';

class AppNavigator extends StatefulWidget {
  @override
  _AppNavigatorState createState() => _AppNavigatorState();
}

class _AppNavigatorState extends State<AppNavigator> {
  int _currentIndex = 0;

  final List<Widget> _pages = [
    BookshelfPage(),
    ReadingHistoryPage(),
    SettingsPage(),
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: IndexedStack(
        index: _currentIndex,
        children: _pages,
      ),
      bottomNavigationBar: BottomNavigationBar(
        currentIndex: _currentIndex,
        onTap: (index) {
          setState(() {
            _currentIndex = index;
          });
        },
        type: BottomNavigationBarType.fixed,
        items: [
          BottomNavigationBarItem(
            icon: Icon(Icons.library_books_outlined),
            activeIcon: Icon(Icons.library_books),
            label: '书架',
          ),
          BottomNavigationBarItem(
            icon: Icon(Icons.history_outlined),
            activeIcon: Icon(Icons.history),
            label: '历史',
          ),
          BottomNavigationBarItem(
            icon: Icon(Icons.settings_outlined),
            activeIcon: Icon(Icons.settings),
            label: '设置',
          ),
        ],
      ),
    );
  }
}

// 临时页面，后续会替换
class BookshelfPage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Books'),
        actions: [
          IconButton(
            icon: Icon(Icons.add_circle_outline),
            onPressed: () {
              ScaffoldMessenger.of(context).showSnackBar(
                SnackBar(content: Text('添加书籍功能开发中...')),
              );
            },
          ),
        ],
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(
              Icons.library_books,
              size: 64.sp,
              color: Theme.of(context).primaryColor,
            ),
            SizedBox(height: 16.h),
            Text(
              '暂无书籍',
              style: Theme.of(context).textTheme.bodyLarge,
            ),
            SizedBox(height: 8.h),
            Text(
              '点击右上角 + 号添加书籍',
              style: Theme.of(context).textTheme.labelMedium,
            ),
          ],
        ),
      ),
    );
  }
}

class ReadingHistoryPage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('阅读历史')),
      body: Center(
        child: Text('阅读历史页面开发中...'),
      ),
    );
  }
}

class SettingsPage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: Text('设置')),
      body: Center(
        child: Text('设置页面开发中...'),
      ),
    );
  }
}
```

### 6. 运行项目
```bash
# 运行在模拟器或真机上
flutter run

# 或者指定平台
flutter run -d android
flutter run -d ios
```

### 7. 下一步开发计划

第一周完成：
- ✅ 项目基础架构
- ✅ 主题系统
- ✅ 主导航框架
- 📋 数据库设计
- 📋 文件服务
- 📋 基础组件库

---

## 🔧 开发工具配置

### VS Code推荐插件
```json
{
  "recommendations": [
    "dart-code.dart-code",
    "dart-code.flutter",
    "alexisvt.flutter-snippets",
    "nash.awesome-flutter-snippets",
    "luanpotter.dart-import",
    "ricardoemerson.create-flutter-widgets-and-classes"
  ]
}
```

### Android Studio插件
- Flutter
- Dart
- Flutter Inspector
- Flutter Enhancement Suite

---

## 📊 第一周里程碑检查

- [ ] 项目成功创建并运行
- [ ] 主题系统正常工作（明暗主题切换）
- [ ] 底部导航正常切换
- [ ] 屏幕适配正常（不同设备尺寸）
- [ ] 代码结构清晰，符合设计理念

完成这些基础设置后，你就可以开始按照《开发流程计划.md》中的详细计划逐步开发各个功能模块了！

每个阶段完成后，记得进行代码review和功能测试，确保质量。